<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Detalle del Pedido #{{ pedido.id }}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<div class="container mt-5">
    <h2>üì¶ Detalle del Pedido #{{ pedido.id }}</h2>
    <a href="{{ url_for('admin_pedidos') }}" class="btn btn-secondary mb-3">‚Üê Volver a pedidos</a>

    <p><strong>Cliente:</strong> {{ pedido.cliente }}</p>
    <p><strong>Fecha:</strong> {{ pedido.fecha }}</p>
    <p><strong>Estado actual:</strong> {{ pedido.estado }}</p>

    <div class="mb-3">
        <form action="{{ url_for('admin_cambiar_estado', pedido_id=pedido.id) }}" method="post">
            <label for="nuevo_estado" class="form-label">Cambiar estado:</label>
            <select name="nuevo_estado" id="nuevo_estado" class="form-select w-50">
                <option value="Pendiente">Pendiente</option>
                <option value="Enviado">Enviado</option>
                <option value="Entregado">Entregado</option>
            </select>
            <button type="submit" class="btn btn-warning mt-2">Actualizar</button>
        </form>
    </div>

    <div class="card p-3 bg-white shadow-sm">
        <h5>üßæ Productos:</h5>
        <ul class="list-group">
            {% for item in pedido.productos %}
            <li class="list-group-item d-flex justify-content-between">
                <div>
                    <strong>{{ item.nombre }}</strong><br>
                    Cantidad: {{ item.cantidad }} | Precio unitario: ${{ "{:,}".format(item.precio) }}
                </div>
                <div>
                    Subtotal: ${{ "{:,}".format(item.precio * item.cantidad) }}
                </div>
            </li>
            {% endfor %}
        </ul>
    </div>

    <div class="mt-3">
        <h5>Total pagado: ${{ "{:,}".format(pedido.total) }}</h5>
    </div>
</div>

</body>
</html>
